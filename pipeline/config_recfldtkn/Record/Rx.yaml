# %%%%%%%%%%%%%%%%%%%%%%%%%%%%%% TableBase sources from different cohorts.
CohortInfo: # Cohort
  RawData2023Nov_Trulicity:
    RxBase: 
      raw_data_path: $DATA_RAW$/2023_11_30_30days_Trulicity/prescription_df_de_identified.csv
      RawRootID: 'patient_id_encoded'
      RecNumColumn: 'prescription' # in Human2RecNum, the related raw table name
      raw_columns: 
        - patient_id_encoded
        - invitation_id_encoded
        - prescription_id_encoded
        - start_date
        - invitation_date
        - updated_date
        - insurance_start_date
        - written_date
        - date_fdb_updated
        - prescriber_npi
        - state_code
        - ncpdp_id
        - pharmacy_name_rx
        - simple_pharmacy_name_rx
        - specialty_pharmacy
        - pharmacy_zip_code_3
        - ndc_id
        - drug_name
        - drug_description
        - generic_id
        - top_200_branded_drugs
        - top_50_generic_drugs
        - brand_source
        - fill_number
        - refills_available
        - quantity
        - days_supply
        - package_size
        - package_units
        - quantity_unit
        - strength
        - strength_units
        - total_package_strength
        - content_id
        - prescription_type
        - directions
        - delivery_type
        - controlled_substance_code
        - campaign_id
        - show_rems_campaigns
        - show_coupon_campaigns
        - show_educational_campaigns
        - show_internal_campaigns
        - show_target_campaigns
        - show_experimental_campaigns
        - send_refill_reminder_messages
        - send_renewal_reminder_messages
        - supports_hippo_prices
        - supports_hippo_prices65
        - supports_copay_prices
        - supports_hippo_prices_medicare
        - source_id
        - record_locator_encoded
        - customer_type
        - organization_type
        - suppliers
        - group_id
        - rx_bin
        - rx_pcn
        - legend_status
        - plan_name
        - legal_business_name
        - primary_dispenser_type
        - primary_dispenser_type_code
        - dispenser_class_code
        - dispenser_class
        - secondary_dispenser_type_code
        - tertiary_dispenser_type_code
        - ther_eq_hierarchy_name
        - ther_eq_parent_name
        - ther_eq_ult_parent_name
        - ther_eq_ult_child_ind
        - ther_eq_ult_parent_etc_id
        - ther_eq_hierarchy_level
        - therapeutic_equivalence_id
        - rxnorm_scd
        - rxnorm_sbd
        - fdb_med_id
        - form


# %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  where to save the Record data.
RecName: Rx    # name of the record.
RecID: RxID    # ID of the record. not necessary to be like this: RecID = RecName + 'ID'.
RecIDChain: 
  - PID
  - PInvID
  - RxID
RawRecID:
  - prescription_id_encoded 
RecDT: DT

# %%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Add Parent Rec is Parent Rec is not Patient.
ParentRecName: 'PInv'

# %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  the final fld_cols to save.
attr_cols:
  - PID
  - PInvID
  - RxID
  - prescription_id_encoded
  - DT
  - start_date
  - invitation_date
  - insurance_start_date
  - written_date
  - date_fdb_updated
  # physician
  - prescriber_npi
  # pharmacy
  - ncpdp_id
  - pharmacy_name_rx
  - simple_pharmacy_name_rx
  - specialty_pharmacy
  - pharmacy_zip_code_3
  # drug
  - ndc_id
  - drug_name
  - drug_description
  - generic_id
  - top_200_branded_drugs
  - top_50_generic_drugs
  - brand_source
  # quantity
  - fill_number
  - refills_available
  - quantity_unit
  - quantity
  - days_supply
  - package_size
  - package_units
  - strength
  - strength_units
  - total_package_strength
  # directions
  - directions
  - delivery_type
  - legend_status
  # campaign
  - show_rems_campaigns
  - show_coupon_campaigns
  - show_educational_campaigns
  - show_internal_campaigns
  - show_target_campaigns
  - show_experimental_campaigns
  - send_refill_reminder_messages
  - send_renewal_reminder_messages
  - supports_hippo_prices
  - supports_hippo_prices65
  - supports_copay_prices
  - supports_hippo_prices_medicare
  # insurance
  - rx_bin
  - rx_pcn
  - dispenser_class
  - primary_dispenser_type
  - campaign_id
  - record_locator_encoded
  - source_id
  - group_id
  - customer_type
  - organization_type
  - plan_name
  - suppliers
  - ther_eq_hierarchy_name
  - ther_eq_parent_name
  - ther_eq_ult_parent_name
  - ther_eq_ult_child_ind
  - ther_eq_ult_parent_etc_id
  - ther_eq_hierarchy_level
  - therapeutic_equivalence_id

# the transform py function is available in rawrec2recfld folder.
pypath: 

FldTknInfo:

  Rx-BrandCateTkn:
    FldTknName: Rx-BrandCateTkn
    value_cols:
      - ndc_id
      - drug_name
      - drug_description
      - generic_id
      - top_200_branded_drugs
      - top_50_generic_drugs
      - brand_source

  Rx-CmpCateTkn:
    FldTknName: Rx-CmpCateTkn
    value_cols:
      - show_rems_campaigns
      - show_coupon_campaigns
      - show_educational_campaigns
      - show_internal_campaigns
      - show_target_campaigns
      - show_experimental_campaigns

  Rx-InsCateTkn:
    FldTknName: Rx-InsCateTkn
    value_cols:
      - rx_bin
      - rx_pcn
      - plan_name

  Rx-ServiceCateTkn:
    FldTknName: Rx-ServiceCateTkn
    value_cols:
      - send_refill_reminder_messages
      - send_renewal_reminder_messages
      - supports_hippo_prices
      - supports_hippo_prices65
      - supports_copay_prices
      - supports_hippo_prices_medicare

  Rx-SysCateTkn:
    FldTknName: Rx-SysCateTkn
    value_cols:
      - delivery_type
      - legend_status
      - dispenser_class
      - primary_dispenser_type
      - customer_type
      - organization_type
      - suppliers
      - source_id
      - group_id

  Rx-QuantN2CTkn:
    FldTknName: Rx-QuantN2CTkn
    value_cols:
      - refills_available
      - quantity
      - days_supply     

  Rx-QuantNumeTkn:
    FldTknName: Rx-QuantNumeTkn
    value_cols:
      - refills_available
      - quantity
      - days_supply  
  
  Rx-TherEqCateTkn:
    FldTknName: Rx-TherEqCateTkn
    value_cols:
      - ther_eq_hierarchy_name
      - ther_eq_parent_name
      - ther_eq_ult_parent_name

  Rx-TherEqNumeTkn:
    FldTknName: Rx-TherEqNumeTkn
    value_cols:
      - ther_eq_ult_child_ind
      - ther_eq_ult_parent_etc_id
      - ther_eq_hierarchy_level
      - therapeutic_equivalence_id

  Rx-DrugBasicNumeTkn:
    FldTknName: Rx-DrugBasicNumeTkn
    value_cols:
      - top_200_branded_drugs
      - top_50_generic_drugs

  Rx-DrugBasicCateTkn:
    FldTknName: Rx-DrugBasicCateTkn
    value_cols:
      - brand_source

  Rx-PhmBasicCateTkn:
    FldTknName: Rx-PhmBasicCateTkn
    value_cols:
      - pharmacy_name_rx
      - specialty_pharmacy

  Rx-PhmZip3HousingNumeTkn:
    FldTknName: Rx-PhmZip3HousingNumeTkn
    value_cols:
      - pharmacy_zip_code_3

      

